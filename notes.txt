Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Dim pptApp As Object
    Dim pptPres As Object
    Dim fullPath As String
    Dim fileName As String
    Dim slideNum As Integer
    Dim parentFolder As String

    ' 1. Check if the double-click happened in your range
    If Not Intersect(Target, Range("D6:D13")) Is Nothing Then
        Cancel = True 

        ' 2. Define the File and Parent Folder
        ' This line calculates the folder one level up from your Excel file
        parentFolder = Left(ThisWorkbook.Path, InStrRev(ThisWorkbook.Path, "\") - 1)
        fileName = "Charter Dev Form_v1.ppsx"
        fullPath = parentFolder & "\" & fileName
        
        ' DEBUG: Uncomment the next line if it still fails to see the path
        ' MsgBox "Looking for: " & fullPath

        ' 3. Get slide number from Column E (one to the right of D)
        slideNum = Val(Target.Offset(0, 1).Value)

        On Error Resume Next
        Set pptApp = GetObject(Class:="PowerPoint.Application")
        
        If pptApp Is Nothing Then
            Set pptApp = CreateObject(Class:="PowerPoint.Application")
            pptApp.Visible = True
        End If
        
        ' 4. Look for the file
        Set pptPres = pptApp.Presentations(fileName)
        
        If pptPres Is Nothing Then
            ' If not open, try to open it
            Set pptPres = pptApp.Presentations.Open(fullPath)
        End If
        
        ' 5. Navigate
        If Not pptPres Is Nothing Then
            ' Since it is a .ppsx, we check if it's in Show mode or Edit mode
            If pptPres.SlideShowWindow Is Nothing Then
                pptPres.Slides(slideNum).Select
            Else
                pptPres.SlideShowWindow.View.GotoSlide slideNum
            End If
            
            pptApp.WindowState = 3 
            AppActivate pptApp.Caption
        Else
            MsgBox "File not found! Please check if the file is in: " & parentFolder
        End If
        On Error GoTo 0
    End If
End Sub
