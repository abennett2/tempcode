Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Dim pptApp As Object
    Dim pptPres As Object
    Dim fullPath As String
    Dim fileName As String
    Dim slideNum As Integer

    ' --- CONFIGURATION ---
    ' 1. The full path to your presentation
    fullPath = "C:\Users\YourName\Documents\YourFile.pptx"
    
    ' 2. The range where your "Code Numbers" are
    If Not Intersect(Target, Range("A2:A500")) Is Nothing Then
        Cancel = True ' Stops Excel from entering "Edit Mode"
        
        ' 3. Get slide number from the cell to the RIGHT (Column B)
        slideNum = Val(Target.Offset(0, 1).Value)
        fileName = Mid(fullPath, InStrRev(fullPath, "\") + 1)

        On Error Resume Next
        ' Try to find if PowerPoint is already running
        Set pptApp = GetObject(Class:="PowerPoint.Application")
        
        If pptApp Is Nothing Then
            ' PPT is not open at all - Start it
            Set pptApp = CreateObject(Class:="PowerPoint.Application")
            pptApp.Visible = True
        End If
        
        ' Try to find if the specific FILE is already open
        Set pptPres = pptApp.Presentations(fileName)
        
        If pptPres Is Nothing Then
            ' File is not open - Open it
            Set pptPres = pptApp.Presentations.Open(fullPath)
        End If
        
        ' Jump to the slide and bring to front
        If Not pptPres Is Nothing Then
            pptPres.Slides(slideNum).Select
            pptApp.WindowState = 3 ' Maximized
            AppActivate pptApp.Caption
        End If
        On Error GoTo 0
    End If
End Sub
