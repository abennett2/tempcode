Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
    Dim pptApp As Object
    Dim pptPres As Object
    Dim fullPath As String
    Dim fileName As String
    Dim slideNum As Integer

    ' 1. Get the file path and slide number from the link
    fullPath = Target.Address
    fileName = Mid(fullPath, InStrRev(fullPath, "\") + 1)
    
    If Target.SubAddress <> "" Then
        slideNum = Val(Target.SubAddress)
    Else
        slideNum = 1
    End If

    On Error Resume Next
    ' 2. Look for an existing PowerPoint instance
    Set pptApp = GetObject(Class:="PowerPoint.Application")
    
    If pptApp Is Nothing Then
        ' If PPT isn't open at all, let Excel handle it normally and exit
        Exit Sub
    End If
    
    ' 3. Check if THIS specific file is already open
    Set pptPres = pptApp.Presentations(fileName)
    
    If Not pptPres Is Nothing Then
        ' SUCCESS: The file is open. Navigate and stop Excel from opening a new one.
        pptPres.Slides(slideNum).Select
        pptApp.WindowState = 3 ' Maximized
        AppActivate pptApp.Caption
        
        ' This is the trick: we've done the work, so we don't need Excel to do more.
    End If
    On Error GoTo 0
End Sub
