Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim pptApp As Object, pptPres As Object
    Dim fullPath As String, fileName As String, folderPath As String
    Dim slideNum As Integer

    ' 1. Only run if a SINGLE cell in range is clicked
    If Not Intersect(Target, Range("D3:D500")) Is Nothing Then
        If Target.Cells.Count > 1 Then Exit Sub

        ' 2. SAFETY CHECK: Only proceed if there is a slide number
        If Target.Offset(0, 1).Value = "" Or Not IsNumeric(Target.Offset(0, 1).Value) Then
            Exit Sub 
        End If
        
        slideNum = Val(Target.Offset(0, 1).Value)
        folderPath = Left(ThisWorkbook.Path, InStrRev(ThisWorkbook.Path, "/") - 1)
        fileName = "Charter Dev Form_v1.ppsx"
        fullPath = folderPath & "/" & fileName

        On Error Resume Next
        Set pptApp = GetObject(Class:="PowerPoint.Application")
        If pptApp Is Nothing Then
            Set pptApp = CreateObject(Class:="PowerPoint.Application")
            pptApp.Visible = True
        End If
        
        Set pptPres = pptApp.Presentations(fileName)
        If pptPres Is Nothing Then
            Set pptPres = pptApp.Presentations.Open(fullPath)
        End If
        
        If Not pptPres Is Nothing Then
            ' Navigate to Slide
            If pptPres.SlideShowWindow Is Nothing Then
                pptPres.Slides(slideNum).Select
            Else
                pptPres.SlideShowWindow.View.GotoSlide slideNum
            End If
            
            ' 3. WINDOW MANAGEMENT
            pptApp.Visible = True
            pptApp.WindowState = 3 ' Maximized
            
            AppActivate "PowerPoint" 
        End If
        
        ' 4. FOCUS FIX
        ' Instead of selecting a different cell, "deselect" and re-select
        ' This allows the user to click the SAME cell twice if needed
        Application.EnableEvents = False ' Prevent the code from re-triggering itself
        Target.Offset(0, 1).Select       ' Briefly move right
        Target.Select                    ' Move back to the "Link" cell
        Application.EnableEvents = True
        
        On Error GoTo 0
    End If
End Sub
