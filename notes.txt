Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    Dim pptApp As Object
    Dim pptPres As Object
    Dim fullPath As String
    Dim fileName As String
    Dim slideNum As Integer
    Dim folderPath As String

    ' 1. Check the range
    If Not Intersect(Target, Range("D6:D13")) Is Nothing Then
        Cancel = True 

        ' 2. SHAREPOINT PATH LOGIC
        ' Get the current folder path from the URL
        folderPath = Left(ThisWorkbook.Path, InStrRev(ThisWorkbook.Path, "/") - 1)
        fileName = "Charter Dev Form_v1.ppsx"
        
        ' Construct the path to the parent folder
        ' In SharePoint, we use "/" instead of "\"
        fullPath = folderPath & "/" & fileName
        
        ' 3. Get slide number from Column E
        slideNum = Val(Target.Offset(0, 1).Value)
        If slideNum = 0 Then slideNum = 1

        On Error Resume Next
        ' 4. Connect to PowerPoint
        Set pptApp = GetObject(Class:="PowerPoint.Application")
        If pptApp Is Nothing Then
            Set pptApp = CreateObject(Class:="PowerPoint.Application")
            pptApp.Visible = True
        End If
        
        ' 5. Open the presentation if not already open
        ' We use the "Friendly Name" to check if it's already open
        Set pptPres = pptApp.Presentations("Charter Dev Form_v1.ppsx")
        
        If pptPres Is Nothing Then
            ' If not open, open it using the SharePoint URL
            Set pptPres = pptApp.Presentations.Open(fullPath)
        End If
        
        ' 6. Navigate to Slide
        If Not pptPres Is Nothing Then
            If pptPres.SlideShowWindow Is Nothing Then
                pptPres.Slides(slideNum).Select
            Else
                pptPres.SlideShowWindow.View.GotoSlide slideNum
            End If
            
            pptApp.Visible = True
            pptApp.WindowState = 3 
            AppActivate "PowerPoint" ' Simplified activation for SharePoint
        Else
            MsgBox "SharePoint Error: Could not find the file at " & vbCrLf & fullPath
        End If
        On Error GoTo 0
    End If
End Sub
